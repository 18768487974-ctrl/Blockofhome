import{r as e,b as a,d as l,y as s,c as t,h as o,f as n,g as c,p as i,v as r,i as d,T as u,F as v,k as m,n as p,t as g,B as w,m as h,C as y,o as f}from"./vue-vendor-BMkgI9aZ.js";import{_ as b,U as k,F as x}from"./ui-components-D_SHk2_O.js";import{g as C,a as L}from"./useNews-4YB_saz-.js";const _={class:"newsroom-page"},I={class:"filter-bar"},M={class:"container"},T={class:"search-container"},j={class:"search-wrapper"},z={key:0,class:"search-suggestions"},E=["onMousedown"],F={class:"suggestion-title"},S={class:"suggestion-category"},$={class:"filter-container"},B=["onClick","data-category"],D={class:"news-container"},A=["data-category","data-id","onClick"],H={class:"news-image"},N=["srcset"],U=["srcset"],G=["src","alt"],O={class:"news-date"},P={class:"news-content"},V={class:"news-category"},W={class:"news-title-card"},Y={class:"news-excerpt"},q={class:"news-meta"},J={class:"news-author"},K={class:"author-avatar"},Q={class:"modal-header"},R={class:"modal-meta"},X={id:"modalDate"},Z={id:"modalCategory"},ee={id:"modalAuthor"},ae={id:"modalTitle",class:"modal-title"},le={class:"modal-body"},se=["srcset"],te=["srcset"],oe=["src","alt"],ne=["innerHTML"],ce=b({__name:"Newsroom",setup(b){const ce=e(C()),ie=e([...ce.value]),re=e([{label:"全部新闻",value:"all"},{label:"活动公告",value:"event"},{label:"更新日志",value:"update"},{label:"社区动态",value:"community"},{label:"官方通知",value:"announce"}]),de=e("all"),ue=e(""),ve=e(!1),me=a(()=>{if(!ue.value.trim())return[];const e=ue.value.toLowerCase().trim();return ce.value.filter(a=>a.title.toLowerCase().includes(e)||a.excerpt.toLowerCase().includes(e)||a.author.toLowerCase().includes(e)).slice(0,5)}),pe=()=>{setTimeout(()=>{ve.value=!1},200)},ge=e(!1),we=e(null),he=e(null),ye=e([]);let fe=null;const be=()=>{let e=[...ce.value];const a=ue.value.toLowerCase().trim();a?e=e.filter(e=>e.title.toLowerCase().includes(a)||e.excerpt.toLowerCase().includes(a)||e.author.toLowerCase().includes(a)||e.content&&e.content.toLowerCase().includes(a)):"all"!==de.value&&(e=e.filter(e=>e.category===de.value)),ie.value=e,y(()=>{Ie()})},ke=()=>{be()},xe=()=>{ue.value="",be()},Ce=()=>{ge.value=!1,document.body.style.overflow=""},Le=e=>{const a=new Date(e);return`${a.getFullYear()}/${String(a.getMonth()+1).padStart(2,"0")}/${String(a.getDate()).padStart(2,"0")}`},_e=e=>e.replace(/\.(png|jpg|jpeg)$/i,".webp"),Ie=()=>{fe&&fe.disconnect(),fe=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&e.target.classList.add("visible")})},{threshold:.1,rootMargin:"0px 0px -50px 0px"}),y(()=>{ye.value&&ye.value.forEach(e=>{e&&fe.observe(e)})})},Me=e=>{ge.value&&e.target.classList.contains("news-modal")&&Ce()};return l(()=>{document.body.classList.add("is-loaded"),Ie(),document.addEventListener("click",Me)}),s(()=>{fe&&fe.disconnect(),document.removeEventListener("click",Me)}),(e,a)=>(f(),t("div",_,[o(k),a[7]||(a[7]=n("header",{class:"news-header"},[n("h1",{class:"news-title"},"新闻中心"),n("p",{class:"news-subtitle"},"记录方块之家的每一个重要时刻")],-1)),n("div",I,[n("div",M,[n("div",T,[n("div",j,[a[3]||(a[3]=n("i",{class:"icon-search"},null,-1)),i(n("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=e=>ue.value=e),placeholder:"搜索新闻标题、内容或作者...",onInput:ke,onFocus:a[1]||(a[1]=e=>ve.value=!0),onBlur:pe,class:"search-input",autocomplete:"off",name:"news-search-input",spellcheck:"false"},null,544),[[r,ue.value]]),ue.value?(f(),t("button",{key:0,onClick:xe,class:"clear-search"}," × ")):c("",!0),o(u,{name:"fade"},{default:d(()=>[ve.value&&ue.value&&me.value.length>0?(f(),t("div",z,[(f(!0),t(v,null,m(me.value,e=>(f(),t("div",{key:e.id,class:"suggestion-item",onMousedown:a=>(e=>{ue.value=e.title,ve.value=!1,be(),window.scrollTo({top:0,behavior:"smooth"})})(e)},[n("span",F,g(e.title),1),n("span",S,g(w(L)(e.category)),1)],40,E))),128))])):c("",!0)]),_:1})])]),n("div",$,[(f(!0),t(v,null,m(re.value,e=>(f(),t("div",{key:e.value,class:p(["filter-tag",{active:de.value===e.value}]),onClick:a=>{return l=e.value,de.value=l,void be();var l},"data-category":e.value},g(e.label),11,B))),128))])])]),n("div",D,[n("div",{class:"news-grid",ref_key:"newsGrid",ref:he},[(f(!0),t(v,null,m(ie.value,(e,l)=>(f(),t("div",{key:e.id,class:"news-card","data-category":e.category,"data-id":e.id,onClick:a=>(e=>{we.value=e,ge.value=!0,document.body.style.overflow="hidden"})(e),ref_for:!0,ref_key:"newsCards",ref:ye},[n("div",H,[n("picture",null,[n("source",{srcset:_e(e.image),type:"image/webp"},null,8,N),n("source",{srcset:e.image,type:"image/png"},null,8,U),n("img",{src:e.image,alt:e.title,loading:"lazy",decoding:"async",fetchpriority:"low",sizes:"(max-width: 768px) 90vw, (max-width: 1200px) 45vw, 33vw"},null,8,G)]),n("div",O,g(Le(e.date)),1)]),n("div",P,[n("span",V,g(w(L)(e.category)),1),n("h3",W,g(e.title),1),n("p",Y,g(e.excerpt),1),n("div",q,[n("div",J,[n("div",K,g(e.author.charAt(0)),1),n("span",null,g(e.author),1)]),a[4]||(a[4]=n("span",null,"阅读全文 →",-1))])])],8,A))),128))],512),n("div",{class:p(["no-results",{show:0===ie.value.length}])},[...a[5]||(a[5]=[n("i",{class:"icon-file",style:{"font-size":"48px",color:"#ddd","margin-bottom":"20px"}},null,-1),n("h3",null,"暂无相关新闻",-1),n("p",null,"请尝试其他筛选条件",-1)])],2),a[6]||(a[6]=n("div",{class:"load-more"},[n("button",{class:"load-more-btn",id:"loadMoreBtn"},"加载更多新闻")],-1))]),ge.value?(f(),t("div",{key:0,class:"news-modal",onClick:Ce},[n("div",{class:"modal-content",onClick:a[2]||(a[2]=h(()=>{},["stop"]))},[n("span",{class:"modal-close",onClick:Ce},"×"),n("div",Q,[n("div",R,[n("span",X,g(Le(we.value.date)),1),n("span",Z,g(w(L)(we.value.category)),1),n("span",ee,"作者："+g(we.value.author),1)]),n("h2",ae,g(we.value.title),1)]),n("div",le,[n("picture",null,[n("source",{srcset:_e(we.value.image),type:"image/webp",id:"modalImageWebp"},null,8,se),n("source",{srcset:we.value.image,type:"image/png",id:"modalImagePng"},null,8,te),n("img",{src:we.value.image,alt:we.value.title,class:"modal-image",id:"modalImage",loading:"lazy",decoding:"async",fetchpriority:"low",sizes:"(max-width: 768px) 90vw, 800px"},null,8,oe)]),n("div",{class:"modal-content-text",innerHTML:we.value.content},null,8,ne)])])])):c("",!0),o(x)]))}},[["__scopeId","data-v-7ca33b16"]]);export{ce as default};
