import{c as e,a,o as s,b as n,u as t,r as o,d as r,e as l,w as i,f as d,g as u,h as c,i as v,j as m,F as g,k as h,n as p,l as w,t as f,m as S,p as E,v as I,q as b,s as _}from"./vue-vendor-BMkgI9aZ.js";const y=(e,a)=>{const s=e.__vccOpts||e;for(const[n,t]of a)s[n]=t;return s},k={class:"footer-pages"},L=y({__name:"Footer",setup:n=>(n,t)=>(s(),e("div",k,[...t[0]||(t[0]=[a('<div class="main-nav-bottom" data-v-fca6d1dd><div class="main-nav__row" data-v-fca6d1dd><div class="menu-social-links-container" data-v-fca6d1dd><ul class="menu-social-links" data-v-fca6d1dd><li data-v-fca6d1dd><a href="#" class="link-underline cursor-link" data-v-fca6d1dd></a></li><li data-v-fca6d1dd><a href="#" class="link-underline cursor-link" data-v-fca6d1dd></a></li><li data-v-fca6d1dd><a href="#" class="link-underline cursor-link" data-v-fca6d1dd></a></li></ul></div><div class="privacy-policy-link" data-v-fca6d1dd><span data-v-fca6d1dd><a target="_blank" href="#" data-v-fca6d1dd></a></span></div></div></div>',1)])]))},[["__scopeId","data-v-fca6d1dd"]]),O=[{username:"admin",password:"block123456",joinDate:"2018-07-21",tags:["管理员","统筹者"],role:"admin",addresses:[]},{username:"LF",password:"DONTFORGETME",joinDate:"2018-07-21",tags:["很有梗","鬼点子生成中","元老级","放肆","人气带动"],role:"user",addresses:[]},{username:"小牛无聊",password:"Fe2O3xnH2O",joinDate:"2018-07-21",tags:["建筑大神","pvp大神","指令大神","红石大神","手工大神","元老级"],role:"user",addresses:[]},{username:"雨芙蕖喵",password:"YUFUQU",joinDate:"2025-08-27",tags:["氛围组","很有梗","牛牛派","熬夜大神（曾经）","找茬"],role:"user",addresses:[{receiver:"曼波",phone:"18850282670",address:"福建省/福州市/闽侯县/甘蔗街道福建卫生职业技术学院",alias:"Ṭ̣雨芙蕖ᰔ᪚"}]},{username:"Ryyik",password:"iloveboh",joinDate:"2018-07-21",tags:["鬼点子神生成","摄影视频爱好者","羽毛球","策划者","元老级"],role:"user",addresses:[]},{username:"Endgalaxy",password:"hjj123456",joinDate:"2018-07-21",tags:["游戏大神","技术在线","元老级","Ryyik最严厉的父亲"],role:"user",addresses:[]},{username:"chengzi",password:"zzh520123",joinDate:"2018-07-21",tags:["休闲玩家","元老级"],role:"user",addresses:[]},{username:"CELLINIA",password:"dingmy20011205",joinDate:"2023-09-16",tags:["老师","文学","ow大王"],role:"user",addresses:[]},{username:"lzaQ",password:"kikikiki8",joinDate:"2022-02-12",tags:["跑酷大神","呆","音游"],role:"user",addresses:[]},{username:"Eleven",password:"Eleven0451",joinDate:"2022-02-12",tags:["跑酷大神","pvp大神","游戏黑洞","凯影","铁男"],role:"user",addresses:[]},{username:"HYP",password:"HYP1006",joinDate:"2019-07-21",tags:["技术流","暖场","氛围组","eleven慈父","元老级"],role:"user",addresses:[]},{username:"LiulanTuT",password:"rlp820217",joinDate:"2025-08-29",tags:["pvp大神","LF粉丝团"],role:"user",addresses:[]},{username:"DRWEKS",password:"Li95123518@@@",joinDate:"2025-09-06",tags:["建筑大神"],role:"user",addresses:[]},{username:"hamburger",password:"hanbao123",joinDate:"2022-01-01",tags:["pvp大神","整活","eleven最严厉的父亲"],role:"user",addresses:[]},{username:"MrXue_",password:"yanshu123",joinDate:"2025-11-27",tags:["方块之家新人"],role:"user",addresses:[]}];function D(e){return O.find(a=>a.username===e)||null}!function(e){const a={STORAGE_KEYS:{IS_LOGGED_IN:"isLoggedIn",USERNAME:"username",LOGIN_TIME:"loginTime",SESSION_ID:"sessionId"},SESSION_TIMEOUT:864e5,get VALID_ACCOUNTS(){return O.map(e=>({username:e.username,password:e.password,role:e.role||"user"}))}};class s{constructor(){this.listeners=[],this.init()}init(){this.checkSessionValidity()}validateCredentials(e,s){return e&&s&&a.VALID_ACCOUNTS.find(a=>a.username===e&&a.password===s)||null}login(e,s){if(!e||!s)return{success:!1,message:"用户名和密码不能为空",user:null};if(s.length<6)return{success:!1,message:"密码长度至少6位",user:null};const n=this.validateCredentials(e,s);if(!n)return{success:!1,message:"用户名或密码错误",user:null};const t=this.generateSessionId(),o=Date.now();try{return localStorage.setItem(a.STORAGE_KEYS.USERNAME,e),localStorage.setItem(a.STORAGE_KEYS.IS_LOGGED_IN,"true"),localStorage.setItem(a.STORAGE_KEYS.LOGIN_TIME,o.toString()),localStorage.setItem(a.STORAGE_KEYS.SESSION_ID,t),this.notifyListeners("login",{username:e,role:n.role}),{success:!0,message:"登录成功",user:{username:e,role:n.role}}}catch(r){return{success:!1,message:"登录失败，请重试",user:null}}}logout(){try{const e=localStorage.getItem(a.STORAGE_KEYS.USERNAME);return Object.values(a.STORAGE_KEYS).forEach(e=>{localStorage.removeItem(e)}),localStorage.removeItem("boh_user"),this.notifyListeners("logout",{username:e}),!0}catch(e){return!1}}isLoggedIn(){return!("true"!==localStorage.getItem(a.STORAGE_KEYS.IS_LOGGED_IN))&&this.checkSessionValidity()}getCurrentUser(){if(!this.isLoggedIn())return null;const e=localStorage.getItem(a.STORAGE_KEYS.USERNAME);if(!e)return null;const s=a.VALID_ACCOUNTS.find(a=>a.username===e);return s?{username:e,role:s.role}:null}checkSessionValidity(){const e=localStorage.getItem(a.STORAGE_KEYS.LOGIN_TIME);return!!e&&!(Date.now()-parseInt(e,10)>a.SESSION_TIMEOUT&&(this.logout(),1))}generateSessionId(){return"session_"+Date.now()+"_"+Math.random().toString(36).substring(2,15)}addListener(e){"function"==typeof e&&this.listeners.push(e)}removeListener(e){this.listeners=this.listeners.filter(a=>a!==e)}notifyListeners(e,a){this.listeners.forEach(s=>{try{s(e,a)}catch(n){}}),"undefined"!=typeof window&&window.dispatchEvent(new CustomEvent("authStateChange",{detail:{event:e,data:a}}))}hasPermission(e){const a=this.getCurrentUser();return!!a&&("admin"===a.role||a.role===e)}refreshSession(){return!!this.isLoggedIn()&&(localStorage.setItem(a.STORAGE_KEYS.LOGIN_TIME,Date.now().toString()),!0)}}const n=new s;if(void 0!==e&&(e.AuthManager=n,e.AuthManagerClass=s),"undefined"!=typeof window){let e=Date.now();["mousedown","keydown","scroll","touchstart"].forEach(a=>{window.addEventListener(a,()=>{e=Date.now()},{passive:!0})}),setInterval(()=>{n.isLoggedIn()&&Date.now()-e<3e5&&n.refreshSession()},3e5)}"undefined"!=typeof window&&window.addEventListener("storage",e=>{if(e.key===a.STORAGE_KEYS.IS_LOGGED_IN){const s=localStorage.getItem(a.STORAGE_KEYS.USERNAME);"true"===e.newValue?n.notifyListeners("login",{username:s}):n.notifyListeners("logout",{username:s})}})}("undefined"!=typeof window?window:void 0);const A={class:"nav-container"},T={class:"nav-menu"},C={class:"nav-user",id:"nav-user-area"},G={class:"nav-avatar"},R={key:0,class:"unread-dot-nav"},N={class:"nav-username"},U={class:"boh-form-group"},M={class:"boh-form-group"},j={class:"boh-password-wrap"},Y=["type"],K={key:0,class:"boh-auth-error",id:"nav-auth-error"},V={class:"boh-form-links"},F=["disabled"],x=y({__name:"UnifiedNavbar",setup(a){const y=t();_();const k=n(()=>y.path),L=[{name:"index",path:"/",label:"首页"},{name:"newsroom",path:"/newsroom",label:"新闻"},{name:"activities",path:"/activities",label:"活动"},{name:"shop",path:"/shop",label:"周边"},{name:"tutorial",path:"/tutorial",label:"教程"}],O=o(!1),D=()=>{O.value=!O.value;const e=window.innerHeight>window.innerWidth;document.body.style.overflow=e?"":O.value?"hidden":""},x=o(!1),z=o(null),H=()=>{x.value=!x.value},W=e=>{!z.value||z.value.contains(e.target)||e.target.closest(".nav-user-info")||(x.value=!1)},q=o(!1),P=o(""),Q=o(!1),Z=()=>{try{const e=localStorage.getItem("boh_read_messages"),a=e?JSON.parse(e):[],s=[1,2];Q.value=s.some(e=>!a.includes(e))}catch(e){Q.value=!1}},J=()=>{q.value=window.AuthManager.isLoggedIn();const e=window.AuthManager.getCurrentUser();P.value=e?e.username:""},X=o(!1),B=o(!1),$=o(!1),ee=o(!1),ae=o({username:"",password:""}),se=()=>{const{username:e,password:a}=ae.value;ee.value=!1,!e.trim()||!a.trim()||a.length<6||($.value=!0,setTimeout(()=>{window.AuthManager.login(e,a).success?(q.value=!0,P.value=e,X.value=!1,ae.value={username:"",password:""}):ee.value=!0,$.value=!1},500))},ne=()=>{window.AuthManager.logout(),q.value=!1,P.value=""},te=()=>{alert("由于技术限制，请联系网站开发者解决该问题。")},oe=()=>{const e=window.innerHeight>window.innerWidth;window.innerWidth>768&&O.value&&(O.value=!1),document.body.style.overflow=e?"":O.value?"hidden":""},re=()=>{J(),Z()};let le=null;return r(()=>{J(),Z(),O.value=!1,document.body.style.overflow="",window.addEventListener("resize",oe),window.addEventListener("storage",re),le&&clearInterval(le),le=setInterval(()=>{const e=window.AuthManager.isLoggedIn(),a=window.AuthManager.getCurrentUser(),s=a?a.username:"";e===q.value&&s===P.value||J(),Z()},200),document.addEventListener("click",W)}),l(()=>{window.removeEventListener("resize",oe),window.removeEventListener("storage",re),le&&(clearInterval(le),le=null),document.removeEventListener("click",W)}),i(()=>O.value,e=>{const a=window.innerHeight>window.innerWidth;document.body.style.overflow=a?"":e?"hidden":""}),(a,n)=>{const t=m("router-link");return s(),e(g,null,[d("div",{id:"unified-nav-container",class:p(["unified-nav",{"mobile-menu-open":O.value}])},[d("div",A,[c(t,{to:"/",class:"nav-logo"},{default:v(()=>[...n[9]||(n[9]=[d("span",{class:"nav-logo-text"},"方块之家",-1)])]),_:1}),d("ul",T,[(s(),e(g,null,h(L,e=>d("li",{key:e.name},[c(t,{to:e.path,class:p({active:k.value===e.path})},{default:v(()=>[w(f(e.label),1)]),_:2},1032,["to","class"])])),64))]),d("div",C,[q.value?(s(),e("div",{key:0,class:p(["nav-user-info",{"show-dropdown":x.value}]),id:"nav-user-info",title:"点击查看更多",onClick:H},[d("div",G,[w(f(P.value.charAt(0).toUpperCase())+" ",1),Q.value?(s(),e("div",R)):u("",!0)]),d("span",N,f(P.value),1),d("div",{class:"nav-dropdown",ref_key:"dropdownRef",ref:z},[c(t,{to:"/user-center",class:"nav-dropdown-item",onClick:n[0]||(n[0]=e=>x.value=!1)},{default:v(()=>[...n[10]||(n[10]=[w(" 个人中心 ",-1)])]),_:1}),n[11]||(n[11]=d("div",{class:"nav-dropdown-divider"},null,-1)),d("a",{href:"#",class:"nav-dropdown-item",onClick:S(ne,["prevent"])}," 退出登录 ")],512)],2)):(s(),e("button",{key:1,class:"nav-login-btn",id:"nav-login-btn",onClick:n[1]||(n[1]=e=>X.value=!0)}," 登录 "))]),d("div",{class:"nav-hamburger",id:"nav-hamburger",onClick:D},[...n[12]||(n[12]=[d("span",null,null,-1),d("span",null,null,-1),d("span",null,null,-1)])])]),d("div",{class:p(["nav-menu-mobile",{active:O.value}]),id:"nav-menu-mobile"},[(s(),e(g,null,h(L,e=>c(t,{key:e.name,to:e.path,class:p({active:k.value===e.path}),onClick:n[2]||(n[2]=e=>O.value=!1)},{default:v(()=>[w(f(e.label),1)]),_:2},1032,["to","class"])),64))],2)],2),X.value?(s(),e("div",{key:0,class:"boh-login-modal-overlay",id:"nav-login-modal-overlay",onClick:n[8]||(n[8]=e=>X.value=!1)},[d("div",{class:"boh-login-modal-container",onClick:n[7]||(n[7]=S(()=>{},["stop"]))},[d("button",{class:"boh-login-modal-close",id:"nav-login-modal-close",onClick:n[3]||(n[3]=e=>X.value=!1)}," × "),n[18]||(n[18]=d("div",{class:"boh-login-modal-header"},[d("h2",null,"方块之家"),d("p",null,"这里不只有方块。")],-1)),d("form",{class:"boh-login-form",id:"nav-login-form",onSubmit:S(se,["prevent"])},[d("div",U,[n[13]||(n[13]=d("label",{for:"nav-username"},"方块ID",-1)),E(d("input",{type:"text",id:"nav-username","onUpdate:modelValue":n[4]||(n[4]=e=>ae.value.username=e),placeholder:"请输入你的用户名",required:""},null,512),[[I,ae.value.username]]),n[14]||(n[14]=d("div",{class:"boh-error-message"},"方块ID不能为空",-1))]),d("div",M,[n[15]||(n[15]=d("label",{for:"nav-password"},"密码",-1)),d("div",j,[E(d("input",{type:B.value?"text":"password",id:"nav-password","onUpdate:modelValue":n[5]||(n[5]=e=>ae.value.password=e),placeholder:"请输入你的密码",required:""},null,8,Y),[[b,ae.value.password]]),d("button",{type:"button",class:"boh-toggle-password",onClick:n[6]||(n[6]=e=>B.value=!B.value)},f(B.value?"隐藏":"显示"),1)]),n[16]||(n[16]=d("div",{class:"boh-error-message"},"密码不能为空（至少6位）",-1))]),ee.value?(s(),e("div",K," 用户名或密码错误，请重试 ")):u("",!0),d("div",V,[d("a",{href:"#",class:"boh-forgot-password",onClick:S(te,["prevent"])},"忘记密码？"),n[17]||(n[17]=d("a",{href:"https://docs.qq.com/form/page/DRVZ2TmtwZWRYaU5o",class:"boh-register-link",target:"_blank"},"还没有账号？立即注册",-1))]),d("button",{type:"submit",class:"boh-login-btn",disabled:$.value},f($.value?"登录中...":"登录方块之家"),9,F)],32)])])):u("",!0)],64)}}},[["__scopeId","data-v-fad37204"]]);export{L as F,x as U,y as _,D as g};
